<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SCADA LIVE MONITORING</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: black; /* Set background color to black */
    }
  
    #center-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      font-size: 24px;
      color: white; /* Set text color to white */
    }
  
    .hidden {
      display: none;
    }
  
    .hide-button {
      display: none;
    }
  </style>
  
</head>

<body>
  <!-- Visible button at the top -->
  <a href="#CEBECOIII">
    <button id="toggleButton" class="hide-button">Go to CEBECO III</button>
  </a>
  <!-- Text centered on the main page -->
  <div id="center-text">
    NO EC SELECTED
  </div>

  <!-- Main section for dynamically changing content -->
  <section id="dynamicContent" class="EC hidden">
    <div class="youtube-wrapper">
      <div class="overlay"></div>
      <iframe id="youtubeIframe" style="position:absolute; top:0; left:0; width:100%; height:100%;"
        title="YouTube video player" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    </div>
  </section>

  <script>
    // JavaScript to toggle visibility of the EC sections
    // document.getElementById('toggleButton').addEventListener('click', function () {
    //   var ECSections = document.querySelectorAll('.EC');
    //   ECSections.forEach(function (section) {
    //     section.classList.toggle('hidden');
    //   });
    //   var centerText = document.getElementById('center-text');
    //   centerText.classList.toggle('hidden');
    // });

    // Function to set the YouTube video source dynamically
    // function setYouTubeSource(videoId) {
    //   var youtubeIframe = document.getElementById('youtubeIframe');
    //   if (youtubeIframe) {
    //     youtubeIframe.src = youtubeUrl;
    //   }
    // }
    // // Check if the URL contains the anchor for any EC section
    // window.addEventListener('DOMContentLoaded', function () {
    //   var hash = window.location.hash;
    //   if (hash && hash.startsWith('#')) {
    //     var ECSection = document.getElementById(hash.substring(1));
    //     if (ECSection) {
    //       ECSection.classList.remove('hidden');
    //       var centerText = document.getElementById('center-text');
    //       centerText.classList.add('hidden');
    //     }
    //   }
    // });

    window.addEventListener('DOMContentLoaded', function () {
      const urlParams = new URLSearchParams(window.location.search);
      const ecCode = urlParams.get('EC_CODE');

      if (ecCode) {
        const ecSection = document.getElementById(ecCode);
        if (ecSection) {
          ecSection.classList.remove('hidden');
          const centerText = document.getElementById('center-text');
          if (centerText) {
            centerText.classList.add('hidden');
          }
          // Call API endpoint with EC_CODE
          fetchApiData(ecCode);
        } else {
          console.error('Element with ID:', ecCode, 'not found');
        }
      }

      const toggleButton = document.getElementById('toggleButton');
      if (toggleButton) {
        toggleButton.addEventListener('click', function () {
          const targetSection = document.getElementById(ecCode); // Assuming element ID matches EC_CODE
          if (targetSection) {
            targetSection.classList.toggle('hidden');
            const centerText = document.getElementById('center-text');
            if (centerText) {
              centerText.classList.toggle('hidden');
            }
          } else {
            console.error('Element with ID:', ecCode, 'not found');
          }
        });
      }
    });

    async function fetchApiData(ecCode) {
      const apiUrl = 'http://192.168.1.106:3000/api/get-youtube-url/' + ecCode;

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        console.log('API Response:', data);

        // Extract and store YouTube URL from response data
        let youtubeUrl;
        if (data && data.YOUTUBE_URL) {
          youtubeUrl = data.YOUTUBE_URL;
        } else {
          console.warn('API response does not contain "YOUTUBE_URL" property');
        }

        // Use the youtubeUrl variable here (e.g., display the YouTube video)
        if (youtubeUrl) {
          console.log('YouTube URL:', youtubeUrl);
        }
      } catch (error) {
        console.error('Error fetching data:', error);
      }
    }

  </script>
</body>

</html>
